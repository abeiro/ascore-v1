
		<html>
		<head>
		<title>Documentacion CoreG2 Funcion javascript_collector</title>
		</head>
		<style>
		body 		{font-family:verdana,sans,serif; font-size:10px;}
		.mini		{font-size:8px;}
		.box		{border:1px solid gray;background:#EEEEFF;}
		.desc		{font-size:12px;border:1px solid gray; padding:5px;}   
		</style>
		<body>
		<h1>CoreG2 version 0.99.9</h1>
		<h2>javascript_collector</h2>
		<span class="mini">Fichero /var/www/okclasses/Framework/../Framework/SubCore/core.php</span>
		<br><br>Funcion<br><br><br><br><div class="desc"> 
<br>javascript_collector (string data)
<br>
<br>Ordena los scripts del buffer
<br>  
<br>
<br>  
</div>
<br><div class="box"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">javascript_collector</span><span style="color: #007700">(</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Script&nbsp;Headers<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">preg_match_all</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script(.*?)src=(.*?)&gt;(.*?)&lt;/script&gt;#i'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$scriptHeaders</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PREG_PATTERN_ORDER</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$buffer1</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script(.*?)src=(.*?)&gt;(.*?)&lt;/script&gt;#i'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">);<br /><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Inline&nbsp;primary&nbsp;scripts<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">preg_match_all</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script&nbsp;priority="true"&gt;(.*?)&lt;/script&gt;#is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$inlinePrioScripts</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PREG_PATTERN_ORDER</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$buffer12</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script&nbsp;priority="true"&gt;(.*?)&lt;/script&gt;#is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer1</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Inline&nbsp;scripts<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">preg_match_all</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script(.*?)&gt;(.*?)&lt;/script&gt;#is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer12</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$inlineScripts</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PREG_PATTERN_ORDER</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$buffer21</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script(.*?)&gt;(.*?)&lt;/script&gt;#is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer12</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Strip&nbsp;white&nbsp;lines<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$buffer2</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"/^\n+|^[\t\s]*\n+/m"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer21</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;</span><span style="color: #FF8000">/*$from=strpos&nbsp;(&nbsp;$buffer,"&lt;script",0);<br />&nbsp;&nbsp;$xhtml=substr&nbsp;(&nbsp;$buffer,0,$from);<br />&nbsp;&nbsp;if&nbsp;($from===False)<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$buffer;<br />&nbsp;&nbsp;while&nbsp;($from)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to=strpos&nbsp;($buffer,"&lt;/script&gt;",$from+1);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;"Cortar&nbsp;desde&nbsp;$from&nbsp;hasta&nbsp;$to";<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script.=substr&nbsp;(&nbsp;$buffer,$from,$to-$from+strlen("&lt;/script&gt;"))."\n";<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from=strpos&nbsp;(&nbsp;$buffer,"&lt;script",$to+1);<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($from===False)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$xhtml.=substr&nbsp;(&nbsp;$buffer,$to+strlen("&lt;/script&gt;"),-1);<br />&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$xhtml.=substr&nbsp;(&nbsp;$buffer,$to+strlen("&lt;/script&gt;"),$from-($to+strlen("&lt;/script&gt;")));<br />&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><br />&nbsp;&nbsp;</span><span style="color: #0000BB">$jpos</span><span style="color: #007700">=</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;!--_JAVASCRIPTCODE--&gt;"</span><span style="color: #007700">,</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">$inlineScripts</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]),</span><span style="color: #0000BB">$buffer2</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;!--_JAVASCRIPTHCODE--&gt;"</span><span style="color: #007700">,</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">$scriptHeaders</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]).</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">$inlinePrioScripts</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]),</span><span style="color: #0000BB">$jpos</span><span style="color: #007700">);<br />&nbsp;&nbsp;<br /><br />}<br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">?&gt;</span>
</span>
</code></div>
		<br><br>
		<div align="center"><a href="core-index.html">up</a></div>
		<br><br>
		</body>
		