
		<html>
		<head>
		<title>Documentacion CoreG2 Funcion typecast</title>
		</head>
		<style>
		body 		{font-family:verdana,sans,serif; font-size:10px;}
		.mini		{font-size:8px;}
		.box		{border:1px solid gray;background:#EEEEFF;}
		.desc		{font-size:12px;border:1px solid gray; padding:5px;}   
		</style>
		<body>
		<h1>CoreG2 version 0.99.9</h1>
		<h2>typecast</h2>
		<span class="mini">Fichero /var/www/okclasses/Framework/../Framework/SubCore/core.php</span>
		<br><br>Funcion<br><br><br><br><div class="desc"> Casting entre clases 
<br>
<br>
</div>
<br><div class="box"><code><span style="color: #000000">
<span style="color: #0000BB">&lt;?php<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">typecast</span><span style="color: #007700">(</span><span style="color: #0000BB">$old_object</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$new_classname</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;if(</span><span style="color: #0000BB">class_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$new_classname</span><span style="color: #007700">))&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//echo&nbsp;"OLD&lt;br&gt;";<br />&nbsp;&nbsp;&nbsp;&nbsp;//dataDump($old_object);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$old_serialized_object&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #0000BB">serialize</span><span style="color: #007700">(</span><span style="color: #0000BB">$old_object</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$n</span><span style="color: #007700">=</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">":"</span><span style="color: #007700">,</span><span style="color: #0000BB">$old_serialized_object</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$new_serialized_object&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">'O:'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$new_classname</span><span style="color: #007700">)&nbsp;.&nbsp;</span><span style="color: #DD0000">':"'&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #0000BB">$new_classname&nbsp;</span><span style="color: #007700">.&nbsp;</span><span style="color: #DD0000">'":'&nbsp;</span><span style="color: #007700">.</span><span style="color: #0000BB">$n</span><span style="color: #007700">[</span><span style="color: #0000BB">3</span><span style="color: #007700">].</span><span style="color: #DD0000">":"</span><span style="color: #007700">.&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">substr</span><span style="color: #007700">(</span><span style="color: #0000BB">$old_serialized_object</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">strpos</span><span style="color: #007700">(</span><span style="color: #0000BB">$old_serialized_object</span><span style="color: #007700">,</span><span style="color: #DD0000">"{"</span><span style="color: #007700">));<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//echo&nbsp;"Casting&nbsp;OK&nbsp;$old_serialized_object&lt;br&gt;$new_serialized_object";<br />&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;"NEW&lt;br&gt;";<br />&nbsp;&nbsp;&nbsp;&nbsp;//dataDump(unserialize($new_serialized_object));<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #007700">return&nbsp;</span><span style="color: #0000BB">unserialize</span><span style="color: #007700">(</span><span style="color: #0000BB">$new_serialized_object</span><span style="color: #007700">);<br />&nbsp;&nbsp;}<br />&nbsp;&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">debug</span><span style="color: #007700">(</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$new_classname</span><span style="color: #DD0000">&nbsp;no&nbsp;existe&nbsp;o&nbsp;no&nbsp;ha&nbsp;sido&nbsp;definida!!!!"</span><span style="color: #007700">,</span><span style="color: #DD0000">"red"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br />&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #FF8000">/*<br /><br />setLimitRows&nbsp;(int&nbsp;numero_de_filas)<br /><br />Especifica&nbsp;el&nbsp;numero&nbsp;de&nbsp;filas&nbsp;a&nbsp;devolver<br />en&nbsp;una&nbsp;consulta.&nbsp;Se&nbsp;aplicarï¿½&nbsp;atodas&nbsp;las&nbsp;consultas&nbsp;<br />posteriores&nbsp;a&nbsp;la&nbsp;llamada<br /><br />*/<br /><br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">setLimitRows</span><span style="color: #007700">(</span><span style="color: #0000BB">$c</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">,</span><span style="color: #0000BB">$FAK</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;</span><span style="color: #0000BB">$FAK</span><span style="color: #007700">=</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"DEFAULTROWS"</span><span style="color: #007700">];<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"DEFAULTROWS"</span><span style="color: #007700">]=</span><span style="color: #0000BB">$c</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">/*<br /><br />resetLimitRows&nbsp;()<br /><br />Restablece&nbsp;&nbsp;el&nbsp;numero&nbsp;de&nbsp;filas&nbsp;a&nbsp;devolver<br />en&nbsp;una&nbsp;consulta&nbsp;al&nbsp;valor&nbsp;por&nbsp;defecto&nbsp;especificado&nbsp;en&nbsp;fichero<br />de&nbsp;configuracion.&nbsp;Se&nbsp;aplicarï¿½&nbsp;atodas&nbsp;las&nbsp;consultas&nbsp;<br />posteriores&nbsp;a&nbsp;la&nbsp;llamada<br /><br />*/<br /><br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">resetLimitRows</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">,</span><span style="color: #0000BB">$FAK</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"DEFAULTROWS"</span><span style="color: #007700">]=</span><span style="color: #0000BB">$FAK</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">/*<br /><br />setNavVars&nbsp;(array&nbsp;variables_navegacion)<br /><br />El&nbsp;array&nbsp;navvars&nbsp;especifica&nbsp;las&nbsp;variables&nbsp;que<br />se&nbsp;pasarï¿½n&nbsp;entre&nbsp;diferentes&nbsp;paginas.&nbsp;Esto&nbsp;es&nbsp;ï¿½til<br />para&nbsp;la&nbsp;paginaciï¿½n&nbsp;de&nbsp;resultados,&nbsp;manteniendo&nbsp;fijas<br />algunas&nbsp;de&nbsp;ellas.<br /><br />*/<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">setNavVars</span><span style="color: #007700">(</span><span style="color: #0000BB">$vars</span><span style="color: #007700">)&nbsp;{<br />&nbsp;global&nbsp;</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">;<br /><br />&nbsp;</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"NAVVARS"</span><span style="color: #007700">]=</span><span style="color: #0000BB">array_merge</span><span style="color: #007700">(</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"NAVVARS"</span><span style="color: #007700">],</span><span style="color: #0000BB">$vars</span><span style="color: #007700">);<br /><br />}<br /><br /></span><span style="color: #FF8000">/*<br /><br />setNavVarsSeparator&nbsp;(separador)<br /><br />Separador&nbsp;de&nbsp;variables&nbsp;&nbsp;(para&nbsp;usar&nbsp;con&nbsp;mod_rewrite)<br /><br />*/<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">setNavVarsSeparator</span><span style="color: #007700">(</span><span style="color: #0000BB">$t</span><span style="color: #007700">)&nbsp;{<br />&nbsp;global&nbsp;</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">;<br /><br />&nbsp;</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"NAV_SEPARATOR"</span><span style="color: #007700">]=</span><span style="color: #0000BB">$t</span><span style="color: #007700">;<br />&nbsp;</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"NAV_SEPARATOR_I"</span><span style="color: #007700">]=</span><span style="color: #DD0000">""</span><span style="color: #007700">;<br /><br />}<br /><br /></span><span style="color: #FF8000">/*<br /><br />setNavVarsSeparator&nbsp;(separador)<br /><br />Separador&nbsp;de&nbsp;variables&nbsp;&nbsp;(para&nbsp;usar&nbsp;con&nbsp;mod_rewrite)<br /><br />*/<br /><br />/*<br />set_include_dir&nbsp;(string&nbsp;filename|dirname&nbsp;)<br /><br />Usada&nbsp;en&nbsp;la&nbsp;conjuncion&nbsp;con&nbsp;__FILE__<br />Establece&nbsp;una&nbsp;ruta&nbsp;de&nbsp;busqueda&nbsp;para&nbsp;abrir&nbsp;ficheros.<br />Ejemplo&nbsp;comï¿½n:&nbsp;set_include_dir(__FILE__)&nbsp;establece&nbsp;que&nbsp;se&nbsp;buscara<br />en&nbsp;el&nbsp;directorio&nbsp;del&nbsp;script&nbsp;para&nbsp;hacer&nbsp;una&nbsp;apertura&nbsp;de&nbsp;fichero.<br />(open,&nbsp;fopen,&nbsp;fpassthru...)<br /><br />*/<br /><br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">set_include_dir</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;</span><span style="color: #0000BB">$current</span><span style="color: #007700">=</span><span style="color: #0000BB">ini_get</span><span style="color: #007700">(</span><span style="color: #DD0000">"include_path"</span><span style="color: #007700">);&nbsp;&nbsp;<br />&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">ini_set</span><span style="color: #007700">(</span><span style="color: #DD0000">"include_path"</span><span style="color: #007700">,</span><span style="color: #0000BB">dirname</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">).</span><span style="color: #0000BB">_PATH_SYMBOL</span><span style="color: #007700">.</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$current</span><span style="color: #DD0000">"</span><span style="color: #007700">))<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">True</span><span style="color: #007700">;<br />&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">False</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;<br />e_file_exists&nbsp;(string&nbsp;nombre_de_fichero)<br /><br />Chequea&nbsp;la&nbsp;existencia&nbsp;de&nbsp;un&nbsp;fichero<br />buscando&nbsp;en&nbsp;el&nbsp;path&nbsp;actual.&nbsp;Extiende<br />la&nbsp;funcionalidad&nbsp;de&nbsp;file_exists<br />&nbsp;&nbsp;<br />*/<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">e_file_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$CACHE_FILE_EXIST</span><span style="color: #007700">;<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$CACHE_FILE_EXIST</span><span style="color: #007700">[</span><span style="color: #DD0000">"petitions"</span><span style="color: #007700">]++;<br />&nbsp;&nbsp;if&nbsp;(!isset(</span><span style="color: #0000BB">$CACHE_FILE_EXIST</span><span style="color: #007700">[</span><span style="color: #0000BB">$filename</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$current</span><span style="color: #007700">=</span><span style="color: #0000BB">ini_get</span><span style="color: #007700">(</span><span style="color: #DD0000">"include_path"</span><span style="color: #007700">).</span><span style="color: #0000BB">_PATH_SYMBOL</span><span style="color: #007700">.</span><span style="color: #DD0000">"/"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">debug</span><span style="color: #007700">(</span><span style="color: #DD0000">"PATH:&nbsp;</span><span style="color: #0000BB">$current</span><span style="color: #DD0000">"</span><span style="color: #007700">,</span><span style="color: #DD0000">"red"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$dirs</span><span style="color: #007700">=</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #0000BB">_PATH_SYMBOL</span><span style="color: #007700">,</span><span style="color: #0000BB">$current</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">$dirs&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$k</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$v</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$res</span><span style="color: #007700">=</span><span style="color: #0000BB">file_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$v</span><span style="color: #007700">.</span><span style="color: #DD0000">"/</span><span style="color: #0000BB">$filename</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">debug</span><span style="color: #007700">(</span><span style="color: #0000BB">$v</span><span style="color: #007700">.</span><span style="color: #DD0000">"/</span><span style="color: #0000BB">$filename</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$res</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">debug</span><span style="color: #007700">(</span><span style="color: #0000BB">$v</span><span style="color: #007700">.</span><span style="color: #DD0000">"/</span><span style="color: #0000BB">$filename</span><span style="color: #DD0000">"</span><span style="color: #007700">.</span><span style="color: #DD0000">"&nbsp;OK"</span><span style="color: #007700">,</span><span style="color: #DD0000">"blue"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$CACHE_FILE_EXIST</span><span style="color: #007700">[</span><span style="color: #0000BB">$filename</span><span style="color: #007700">]=</span><span style="color: #0000BB">$v</span><span style="color: #007700">.</span><span style="color: #DD0000">"/</span><span style="color: #0000BB">$filename</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$CACHE_FILE_EXIST</span><span style="color: #007700">[</span><span style="color: #DD0000">"cached"</span><span style="color: #007700">]++;<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;(</span><span style="color: #0000BB">$v</span><span style="color: #007700">.</span><span style="color: #DD0000">"/</span><span style="color: #0000BB">$filename</span><span style="color: #DD0000">"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$CACHE_FILE_EXIST</span><span style="color: #007700">[</span><span style="color: #0000BB">$filename</span><span style="color: #007700">]=</span><span style="color: #0000BB">false</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">False</span><span style="color: #007700">;<br />&nbsp;&nbsp;}<br />&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$CACHE_FILE_EXIST</span><span style="color: #007700">[</span><span style="color: #0000BB">$filename</span><span style="color: #007700">];<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;<br />c_fopen&nbsp;(string&nbsp;nombre_de_fichero)<br /><br />Wrapper&nbsp;para&nbsp;fopen,&nbsp;para&nbsp;controlar&nbsp;la&nbsp;cantidad&nbsp;de&nbsp;ficheros&nbsp;abiertos<br />&nbsp;&nbsp;<br />*/<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">c_fopen</span><span style="color: #007700">(</span><span style="color: #0000BB">$fl</span><span style="color: #007700">,</span><span style="color: #0000BB">$mode</span><span style="color: #007700">,</span><span style="color: #0000BB">$inc</span><span style="color: #007700">=</span><span style="color: #0000BB">False</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$FILES_OPENED</span><span style="color: #007700">;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$FILES_OPENED</span><span style="color: #007700">[</span><span style="color: #0000BB">$fl</span><span style="color: #007700">]=</span><span style="color: #0000BB">True</span><span style="color: #007700">;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$FILES_OPENED</span><span style="color: #007700">[</span><span style="color: #DD0000">"total"</span><span style="color: #007700">]++;<br />&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">fopen</span><span style="color: #007700">(</span><span style="color: #0000BB">$fl</span><span style="color: #007700">,</span><span style="color: #0000BB">$mode</span><span style="color: #007700">,</span><span style="color: #0000BB">$inc</span><span style="color: #007700">);<br />}<br /></span><span style="color: #FF8000">/*&nbsp;<br />c_filesize&nbsp;(string&nbsp;nombre_de_fichero)<br /><br />Wrapper&nbsp;para&nbsp;filesize,&nbsp;que&nbsp;busca&nbsp;en&nbsp;el&nbsp;PATH<br />&nbsp;&nbsp;<br />*/<br /><br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">c_filesize</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;</span><span style="color: #0000BB">$serach_name</span><span style="color: #007700">=</span><span style="color: #0000BB">e_file_exists</span><span style="color: #007700">(</span><span style="color: #0000BB">$filename</span><span style="color: #007700">);<br />&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">filesize</span><span style="color: #007700">(</span><span style="color: #0000BB">$serach_name</span><span style="color: #007700">);<br />}<br /><br /><br /></span><span style="color: #FF8000">/*&nbsp;<br />_safe_strftime(string&nbsp;$format,int&nbsp;$timestamp)<br /><br />Uses&nbsp;strftime&nbsp;if&nbsp;timestamp&gt;3600<br />&nbsp;&nbsp;<br />*/<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">_safe_strftime</span><span style="color: #007700">(</span><span style="color: #0000BB">$format</span><span style="color: #007700">,</span><span style="color: #0000BB">$timestamp</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$timestamp</span><span style="color: #007700">&gt;</span><span style="color: #0000BB">3600</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">strftime</span><span style="color: #007700">(</span><span style="color: #0000BB">$format</span><span style="color: #007700">,</span><span style="color: #0000BB">$timestamp</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"--"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;<br />_fixed(string&nbsp;cade,&nbsp;int&nbsp;size)<br /><br />Wrapper&nbsp;para&nbsp;cademas,&nbsp;las&nbsp;amplia&nbsp;en&nbsp;size/2&nbsp;por&nbsp;cada&nbsp;lado<br />&nbsp;&nbsp;<br />*/<br /><br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">_fixed</span><span style="color: #007700">(</span><span style="color: #0000BB">$string</span><span style="color: #007700">,</span><span style="color: #0000BB">$len</span><span style="color: #007700">=</span><span style="color: #0000BB">17</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;</span><span style="color: #0000BB">$l</span><span style="color: #007700">=</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br />&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$l</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">$len</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$iz</span><span style="color: #007700">=</span><span style="color: #0000BB">str_repeat</span><span style="color: #007700">(</span><span style="color: #DD0000">"&amp;nbsp;"</span><span style="color: #007700">,(</span><span style="color: #0000BB">$len</span><span style="color: #007700">-</span><span style="color: #0000BB">$l</span><span style="color: #007700">)/</span><span style="color: #0000BB">2</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$l</span><span style="color: #007700">%</span><span style="color: #0000BB">2</span><span style="color: #007700">!=</span><span style="color: #0000BB">0</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$de</span><span style="color: #007700">=</span><span style="color: #0000BB">str_repeat</span><span style="color: #007700">(</span><span style="color: #DD0000">"&amp;nbsp;"</span><span style="color: #007700">,((</span><span style="color: #0000BB">$len</span><span style="color: #007700">-</span><span style="color: #0000BB">$l</span><span style="color: #007700">)/</span><span style="color: #0000BB">2</span><span style="color: #007700">)-</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$de</span><span style="color: #007700">=</span><span style="color: #0000BB">$iz</span><span style="color: #007700">;<br />&nbsp;&nbsp;}<br />&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #007700">${</span><span style="color: #0000BB">iz</span><span style="color: #007700">}</span><span style="color: #0000BB">$string</span><span style="color: #007700">{</span><span style="color: #0000BB">$de</span><span style="color: #007700">}</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;<br />_rfixed(string&nbsp;cade,&nbsp;int&nbsp;size)<br /><br />Wrapper&nbsp;para&nbsp;cademas,&nbsp;las&nbsp;amplia&nbsp;en&nbsp;size&nbsp;por&nbsp;la&nbsp;derecha<br />&nbsp;&nbsp;<br />*/<br /><br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">_rfixed</span><span style="color: #007700">(</span><span style="color: #0000BB">$string</span><span style="color: #007700">,</span><span style="color: #0000BB">$len</span><span style="color: #007700">=</span><span style="color: #0000BB">25</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;</span><span style="color: #0000BB">$l</span><span style="color: #007700">=</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #0000BB">$string</span><span style="color: #007700">);<br />&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$l</span><span style="color: #007700">&lt;</span><span style="color: #0000BB">$len</span><span style="color: #007700">)&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$de</span><span style="color: #007700">=</span><span style="color: #0000BB">str_repeat</span><span style="color: #007700">(</span><span style="color: #DD0000">"&amp;nbsp;"</span><span style="color: #007700">,(</span><span style="color: #0000BB">$len</span><span style="color: #007700">-</span><span style="color: #0000BB">$l</span><span style="color: #007700">));<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;return&nbsp;</span><span style="color: #DD0000">"</span><span style="color: #0000BB">$string</span><span style="color: #007700">{</span><span style="color: #0000BB">$de</span><span style="color: #007700">}</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />}<br /><br />function&nbsp;</span><span style="color: #0000BB">_closeSystem</span><span style="color: #007700">()&nbsp;{<br />&nbsp;&nbsp;global&nbsp;</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">,</span><span style="color: #0000BB">$DEBUGHANDLER</span><span style="color: #007700">,</span><span style="color: #0000BB">$CODEINITTIME</span><span style="color: #007700">,</span><span style="color: #0000BB">$monitor</span><span style="color: #007700">;<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$CORETIME</span><span style="color: #007700">=</span><span style="color: #0000BB">getmicrotime</span><span style="color: #007700">()-</span><span style="color: #0000BB">$CODEINITTIME</span><span style="color: #007700">;<br />&nbsp;&nbsp;if&nbsp;(isset(</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"monitor_enabled"</span><span style="color: #007700">]))<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"monitor_enabled"</span><span style="color: #007700">])&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$monitor</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">MonAverageUpdate</span><span style="color: #007700">(</span><span style="color: #0000BB">$CORETIME</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$stats</span><span style="color: #007700">=</span><span style="color: #0000BB">$monitor</span><span style="color: #007700">-&gt;</span><span style="color: #0000BB">MonGetStat</span><span style="color: #007700">();<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">debug</span><span style="color: #007700">(</span><span style="color: #DD0000">"Ending&nbsp;System:&nbsp;Pages&nbsp;</span><span style="color: #007700">{</span><span style="color: #0000BB">$stats</span><span style="color: #007700">[</span><span style="color: #DD0000">"pages"</span><span style="color: #007700">]}</span><span style="color: #DD0000">&nbsp;Average:</span><span style="color: #007700">{</span><span style="color: #0000BB">$stats</span><span style="color: #007700">[</span><span style="color: #DD0000">"avg"</span><span style="color: #007700">]}</span><span style="color: #DD0000">&nbsp;spp"</span><span style="color: #007700">,</span><span style="color: #DD0000">"white"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;}<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;</span><span style="color: #FF8000">//$monitor-&gt;MonClose();<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$err</span><span style="color: #007700">=</span><span style="color: #0000BB">print_r</span><span style="color: #007700">(</span><span style="color: #0000BB">error_get_last</span><span style="color: #007700">(),</span><span style="color: #0000BB">true</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">debug</span><span style="color: #007700">(</span><span style="color: #DD0000">"Debug:&nbsp;</span><span style="color: #0000BB">$err</span><span style="color: #DD0000">"</span><span style="color: #007700">,</span><span style="color: #DD0000">"red"</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">fflush</span><span style="color: #007700">(</span><span style="color: #0000BB">$DEBUGHANDLER</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">debug</span><span style="color: #007700">(</span><span style="color: #DD0000">"Ending&nbsp;System:&nbsp;Total&nbsp;ms&nbsp;of&nbsp;ASCore:</span><span style="color: #0000BB">$CORETIME</span><span style="color: #DD0000">"</span><span style="color: #007700">,</span><span style="color: #DD0000">"white"</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">fclose</span><span style="color: #007700">(</span><span style="color: #0000BB">$DEBUGHANDLER</span><span style="color: #007700">);<br />}<br /><br />function&nbsp;</span><span style="color: #0000BB">getmicrotime</span><span style="color: #007700">(){&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;list(</span><span style="color: #0000BB">$usec</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$sec</span><span style="color: #007700">)&nbsp;=&nbsp;</span><span style="color: #0000BB">explode</span><span style="color: #007700">(</span><span style="color: #DD0000">"&nbsp;"</span><span style="color: #007700">,</span><span style="color: #0000BB">microtime</span><span style="color: #007700">());&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;((float)</span><span style="color: #0000BB">$usec&nbsp;</span><span style="color: #007700">+&nbsp;(float)</span><span style="color: #0000BB">$sec</span><span style="color: #007700">);&nbsp;<br />&nbsp;&nbsp;}&nbsp;<br /><br />function&nbsp;</span><span style="color: #0000BB">core_ucfirst</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">){&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">ucwords</span><span style="color: #007700">(</span><span style="color: #0000BB">strtolower</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">));<br />&nbsp;&nbsp;}&nbsp;<br /><br /></span><span style="color: #FF8000">/*&nbsp;<br />javascript_collector&nbsp;(string&nbsp;data)<br /><br />Ordena&nbsp;los&nbsp;scripts&nbsp;del&nbsp;buffer<br />&nbsp;&nbsp;<br />*/<br />&nbsp;&nbsp;<br /></span><span style="color: #007700">function&nbsp;</span><span style="color: #0000BB">javascript_collector</span><span style="color: #007700">(</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Script&nbsp;Headers<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">preg_match_all</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script(.*?)src=(.*?)&gt;(.*?)&lt;/script&gt;#i'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$scriptHeaders</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PREG_PATTERN_ORDER</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$buffer1</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script(.*?)src=(.*?)&gt;(.*?)&lt;/script&gt;#i'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">);<br /><br /><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Inline&nbsp;primary&nbsp;scripts<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">preg_match_all</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script&nbsp;priority="true"&gt;(.*?)&lt;/script&gt;#is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer1</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$inlinePrioScripts</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PREG_PATTERN_ORDER</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$buffer12</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script&nbsp;priority="true"&gt;(.*?)&lt;/script&gt;#is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer1</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Inline&nbsp;scripts<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">preg_match_all</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script(.*?)&gt;(.*?)&lt;/script&gt;#is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer12</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$inlineScripts</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PREG_PATTERN_ORDER</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$buffer21</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;script(.*?)&gt;(.*?)&lt;/script&gt;#is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer12</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #FF8000">//&nbsp;Strip&nbsp;white&nbsp;lines<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$buffer2</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"/^\n+|^[\t\s]*\n+/m"</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer21</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;</span><span style="color: #FF8000">/*$from=strpos&nbsp;(&nbsp;$buffer,"&lt;script",0);<br />&nbsp;&nbsp;$xhtml=substr&nbsp;(&nbsp;$buffer,0,$from);<br />&nbsp;&nbsp;if&nbsp;($from===False)<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;$buffer;<br />&nbsp;&nbsp;while&nbsp;($from)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$to=strpos&nbsp;($buffer,"&lt;/script&gt;",$from+1);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;//echo&nbsp;"Cortar&nbsp;desde&nbsp;$from&nbsp;hasta&nbsp;$to";<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$script.=substr&nbsp;(&nbsp;$buffer,$from,$to-$from+strlen("&lt;/script&gt;"))."\n";<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$from=strpos&nbsp;(&nbsp;$buffer,"&lt;script",$to+1);<br />&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;($from===False)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$xhtml.=substr&nbsp;(&nbsp;$buffer,$to+strlen("&lt;/script&gt;"),-1);<br />&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;$xhtml.=substr&nbsp;(&nbsp;$buffer,$to+strlen("&lt;/script&gt;"),$from-($to+strlen("&lt;/script&gt;")));<br />&nbsp;&nbsp;}<br />&nbsp;&nbsp;&nbsp;&nbsp;*/<br /><br />&nbsp;&nbsp;</span><span style="color: #0000BB">$jpos</span><span style="color: #007700">=</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;!--_JAVASCRIPTCODE--&gt;"</span><span style="color: #007700">,</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">$inlineScripts</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]),</span><span style="color: #0000BB">$buffer2</span><span style="color: #007700">);<br /><br />&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;!--_JAVASCRIPTHCODE--&gt;"</span><span style="color: #007700">,</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">$scriptHeaders</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]).</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">$inlinePrioScripts</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]),</span><span style="color: #0000BB">$jpos</span><span style="color: #007700">);<br />&nbsp;&nbsp;<br /><br />}<br /><br />function&nbsp;</span><span style="color: #0000BB">css_collector</span><span style="color: #007700">(</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">preg_match_all</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;style(.*?)&gt;(.*?)&lt;/style&gt;#is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$styling</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">PREG_PATTERN_ORDER</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$buffer2</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">'#&lt;style(.*?)&gt;(.*?)&lt;/style&gt;#is'</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">''</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$jpos</span><span style="color: #007700">=</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;!--_CSSCODE--&gt;"</span><span style="color: #007700">,</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">$styling</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]),</span><span style="color: #0000BB">$buffer2</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$jpos</span><span style="color: #007700">;<br /><br />&nbsp;&nbsp;</span><span style="color: #0000BB">$from</span><span style="color: #007700">=</span><span style="color: #0000BB">strpos&nbsp;</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">,</span><span style="color: #DD0000">"&lt;style"</span><span style="color: #007700">,</span><span style="color: #0000BB">0</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$xhtml</span><span style="color: #007700">=</span><span style="color: #0000BB">substr&nbsp;</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">,</span><span style="color: #0000BB">0</span><span style="color: #007700">,</span><span style="color: #0000BB">$from</span><span style="color: #007700">);<br />&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$from</span><span style="color: #007700">===</span><span style="color: #0000BB">False</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">;<br />&nbsp;&nbsp;while&nbsp;(</span><span style="color: #0000BB">$from</span><span style="color: #007700">)&nbsp;{<br /><br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$to</span><span style="color: #007700">=</span><span style="color: #0000BB">strpos&nbsp;</span><span style="color: #007700">(</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">,</span><span style="color: #DD0000">"&lt;/style&gt;"</span><span style="color: #007700">,</span><span style="color: #0000BB">$from</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">debug</span><span style="color: #007700">(</span><span style="color: #DD0000">"CSSCOLLETOR:&nbsp;Cortar&nbsp;desde&nbsp;</span><span style="color: #0000BB">$from</span><span style="color: #DD0000">&nbsp;hasta&nbsp;</span><span style="color: #0000BB">$to</span><span style="color: #DD0000">"</span><span style="color: #007700">,</span><span style="color: #DD0000">"white"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$script</span><span style="color: #007700">.=</span><span style="color: #0000BB">substr&nbsp;</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">,</span><span style="color: #0000BB">$from</span><span style="color: #007700">,</span><span style="color: #0000BB">$to</span><span style="color: #007700">-</span><span style="color: #0000BB">$from</span><span style="color: #007700">+</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;/style&gt;"</span><span style="color: #007700">)).</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$from</span><span style="color: #007700">=</span><span style="color: #0000BB">strpos&nbsp;</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">,</span><span style="color: #DD0000">"&lt;style"</span><span style="color: #007700">,</span><span style="color: #0000BB">$to</span><span style="color: #007700">+</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$from</span><span style="color: #007700">===</span><span style="color: #0000BB">False</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$xhtml</span><span style="color: #007700">.=</span><span style="color: #0000BB">substr&nbsp;</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">,</span><span style="color: #0000BB">$to</span><span style="color: #007700">+</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;/style&gt;"</span><span style="color: #007700">),-</span><span style="color: #0000BB">1</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$xhtml</span><span style="color: #007700">.=</span><span style="color: #0000BB">substr&nbsp;</span><span style="color: #007700">(&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">,</span><span style="color: #0000BB">$to</span><span style="color: #007700">+</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;/style&gt;"</span><span style="color: #007700">),</span><span style="color: #0000BB">$from</span><span style="color: #007700">-(</span><span style="color: #0000BB">$to</span><span style="color: #007700">+</span><span style="color: #0000BB">strlen</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;/style&gt;"</span><span style="color: #007700">)));<br />&nbsp;&nbsp;}<br /><br />&nbsp;&nbsp;</span><span style="color: #0000BB">$jpos</span><span style="color: #007700">=</span><span style="color: #0000BB">str_replace</span><span style="color: #007700">(</span><span style="color: #DD0000">"&lt;!--_CSSCODE--&gt;"</span><span style="color: #007700">,</span><span style="color: #0000BB">$script</span><span style="color: #007700">,</span><span style="color: #0000BB">$xhtml</span><span style="color: #007700">);<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$jpos</span><span style="color: #007700">;<br />}<br /><br /><br />function&nbsp;</span><span style="color: #0000BB">reArrangeMetas</span><span style="color: #007700">(</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">)&nbsp;{<br /><br /><br />&nbsp;&nbsp;<br />&nbsp;</span><span style="color: #0000BB">$ptn&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"/&lt;link.*&gt;/i"</span><span style="color: #007700">;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$ptnh&nbsp;</span><span style="color: #007700">=&nbsp;</span><span style="color: #DD0000">"/&lt;head&gt;/i"</span><span style="color: #007700">;<br />&nbsp;&nbsp;</span><span style="color: #0000BB">preg_match_all</span><span style="color: #007700">(</span><span style="color: #0000BB">$ptn</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$matches</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$toInsert</span><span style="color: #007700">=</span><span style="color: #0000BB">implode</span><span style="color: #007700">(</span><span style="color: #DD0000">"\n"</span><span style="color: #007700">,</span><span style="color: #0000BB">$matches</span><span style="color: #007700">[</span><span style="color: #0000BB">0</span><span style="color: #007700">]);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$newBuffer</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$ptn</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">""</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">);<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">=</span><span style="color: #0000BB">preg_replace</span><span style="color: #007700">(</span><span style="color: #0000BB">$ptnh</span><span style="color: #007700">,&nbsp;</span><span style="color: #DD0000">"&lt;head&gt;\n</span><span style="color: #0000BB">$toInsert</span><span style="color: #DD0000">"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$newBuffer</span><span style="color: #007700">);<br />&nbsp;&nbsp;<br />&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$buffer</span><span style="color: #007700">;<br />}<br /><br />if&nbsp;(!</span><span style="color: #0000BB">function_exists</span><span style="color: #007700">(</span><span style="color: #DD0000">"http_build_query"</span><span style="color: #007700">))&nbsp;{<br /><br />&nbsp;&nbsp;function&nbsp;</span><span style="color: #0000BB">http_build_query</span><span style="color: #007700">(</span><span style="color: #0000BB">$data</span><span style="color: #007700">)&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;foreach&nbsp;(</span><span style="color: #0000BB">$data&nbsp;</span><span style="color: #007700">as&nbsp;</span><span style="color: #0000BB">$keyz</span><span style="color: #007700">=&gt;</span><span style="color: #0000BB">$valuez</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$res</span><span style="color: #007700">.=</span><span style="color: #DD0000">"&amp;</span><span style="color: #0000BB">$keyz</span><span style="color: #DD0000">=</span><span style="color: #0000BB">$valuez</span><span style="color: #DD0000">"</span><span style="color: #007700">;<br />&nbsp;&nbsp;&nbsp;&nbsp;return&nbsp;</span><span style="color: #0000BB">$res</span><span style="color: #007700">;&nbsp;&nbsp;<br />&nbsp;&nbsp;}<br />}<br /><br /></span><span style="color: #FF8000">/*&nbsp;Init&nbsp;code&nbsp;of&nbsp;Core&nbsp;*/<br />/*&nbsp;Debug&nbsp;issues&nbsp;*/<br /><br /></span><span style="color: #0000BB">$CODEINITTIME</span><span style="color: #007700">=</span><span style="color: #0000BB">getmicrotime</span><span style="color: #007700">();<br />if&nbsp;(</span><span style="color: #0000BB">$TrazaStatus</span><span style="color: #007700">&amp;&amp;(!isset(</span><span style="color: #0000BB">$nodebug</span><span style="color: #007700">)))&nbsp;{<br /><br />&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">"REMOTE_ADDR"</span><span style="color: #007700">]==</span><span style="color: #DD0000">"::1"</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">"REMOTE_ADDR_OK"</span><span style="color: #007700">]=</span><span style="color: #DD0000">"udp://localhost"</span><span style="color: #007700">;<br />&nbsp;&nbsp;else<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">"REMOTE_ADDR_OK"</span><span style="color: #007700">]=</span><span style="color: #DD0000">"udp://"</span><span style="color: #007700">.</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">"REMOTE_ADDR"</span><span style="color: #007700">];<br />&nbsp;&nbsp;</span><span style="color: #0000BB">$DEBUGHANDLER</span><span style="color: #007700">=</span><span style="color: #0000BB">fsockopen</span><span style="color: #007700">(</span><span style="color: #0000BB">$_SERVER</span><span style="color: #007700">[</span><span style="color: #DD0000">"REMOTE_ADDR_OK"</span><span style="color: #007700">],</span><span style="color: #0000BB">7869</span><span style="color: #007700">);<br />&nbsp;&nbsp;if&nbsp;(</span><span style="color: #0000BB">$DEBUGHANDLER</span><span style="color: #007700">==</span><span style="color: #0000BB">False</span><span style="color: #007700">)<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">$TrazaStatus</span><span style="color: #007700">=</span><span style="color: #0000BB">False</span><span style="color: #007700">;<br />&nbsp;&nbsp;else&nbsp;{<br />&nbsp;&nbsp;&nbsp;&nbsp;<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">debug</span><span style="color: #007700">(</span><span style="color: #DD0000">"###########################################################################"</span><span style="color: #007700">,</span><span style="color: #DD0000">"white"</span><span style="color: #007700">);<br />&nbsp;&nbsp;&nbsp;&nbsp;</span><span style="color: #0000BB">fputs</span><span style="color: #007700">(</span><span style="color: #0000BB">$DEBUGHANDLER</span><span style="color: #007700">,</span><span style="color: #DD0000">''</span><span style="color: #007700">);<br />&nbsp;&nbsp;}<br />&nbsp;&nbsp;</span><span style="color: #0000BB">register_shutdown_function</span><span style="color: #007700">(</span><span style="color: #DD0000">"_closeSystem"</span><span style="color: #007700">);<br /><br />}<br /><br /><br /></span><span style="color: #FF8000">/*&nbsp;Intl&nbsp;support&nbsp;*/<br /><br /></span><span style="color: #007700">if&nbsp;(isset(</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"LANG"</span><span style="color: #007700">]))&nbsp;{<br />&nbsp;&nbsp;</span><span style="color: #0000BB">setlocale</span><span style="color: #007700">(</span><span style="color: #0000BB">LC_ALL</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"LANG"</span><span style="color: #007700">]);<br /></span><span style="color: #FF8000">//&nbsp;Specify&nbsp;location&nbsp;of&nbsp;translation&nbsp;tables<br />&nbsp;&nbsp;</span><span style="color: #0000BB">bindtextdomain</span><span style="color: #007700">(</span><span style="color: #DD0000">"coreg2"</span><span style="color: #007700">,&nbsp;</span><span style="color: #0000BB">dirname</span><span style="color: #007700">(</span><span style="color: #0000BB">__FILE__</span><span style="color: #007700">).</span><span style="color: #DD0000">"/../Locale/"</span><span style="color: #007700">);<br /></span><span style="color: #FF8000">//&nbsp;Choose&nbsp;domain<br />&nbsp;&nbsp;</span><span style="color: #0000BB">textdomain</span><span style="color: #007700">(</span><span style="color: #DD0000">"coreg2"</span><span style="color: #007700">);<br />}<br /><br /><br /></span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"NAV_SEPARATOR"</span><span style="color: #007700">]=</span><span style="color: #DD0000">"&amp;amp;"</span><span style="color: #007700">;<br /></span><span style="color: #0000BB">$SYS</span><span style="color: #007700">[</span><span style="color: #DD0000">"NAV_SEPARATOR_I"</span><span style="color: #007700">]=</span><span style="color: #DD0000">"?"</span><span style="color: #007700">;<br /><br /><br /><br /></span><span style="color: #0000BB">?&gt;<br /></span><br /><br />&nbsp;&nbsp;&nbsp;&nbsp;?&gt;</span>
</code></div>
		<br><br>
		<div align="center"><a href="core-index.html">up</a></div>
		<br><br>
		</body>
		